// === –û–ë–ù–û–í–õ–ï–ù–ù–´–ï –†–ï–ê–õ–¨–ù–´–ï –°–û–ß–ï–¢–ê–ù–ò–Ø (2024) ===
// –ò—Å—Ç–æ—á–Ω–∏–∫–∏: Wine Folly, —Ä–µ—Å—Ç–æ—Ä–∞–Ω–Ω—ã–µ –∫–∞—Ä—Ç—ã –≤–∏–Ω, —ç–∫—Å–ø–µ—Ä—Ç–Ω—ã–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏
// –ü–æ –¥–∞–Ω–Ω—ã–º Wine Spectator, JamesSuckling.com, Decanter

export const PAIRINGS = {
  REAL_PAIRINGS: {
    '–°—Ç–µ–π–∫ —Ä–∏–±–∞–π': ['–ö–∞–±–µ—Ä–Ω–µ —Å–æ–≤–∏–Ω—å–æ–Ω', '–®–∏—Ä–∞–∑', '–ú–∞–ª—å–±–µ–∫'],
    '–ú–æ—Ä–µ–ø—Ä–æ–¥—É–∫—Ç—ã': ['–°–æ–≤–∏–Ω—å–æ–Ω –ë–ª–∞–Ω', '–í–µ—Ä–º–µ–Ω—Ç–∏–Ω–æ', '–®–∞–±–ª–∏'],
    '–£—Å—Ç—Ä–∏—Ü—ã': ['–®–∞–º–ø–∞–Ω—Å–∫–æ–µ', '–ú—é—Å–∫–∞–¥–µ', '–®–∞–±–ª–∏'],
    '–ü–∞—Å—Ç–∞': ['–ö—å—è–Ω—Ç–∏', '–ë–∞—Ä–±–µ—Ä–∞', '–°–∞–Ω–¥–∂–æ–≤–µ–∑–µ'],
    '–ü–∏—Ü—Ü–∞': ['–ö—å—è–Ω—Ç–∏', '–õ–∞–º–±—Ä—É—Å–∫–æ (—Å—É—Ö–æ–µ)', '–°–∞–Ω–¥–∂–æ–≤–µ–∑–µ'],
    '–°—É—à–∏': ['–†–∏—Å–ª–∏–Ω–≥ (—Å—É—Ö–æ–π)', '–°–∞–∫–µ', '–°–æ–≤–∏–Ω—å–æ–Ω –ë–ª–∞–Ω'],
    '–û—Å—Ç—Ä–∞—è –µ–¥–∞': ['–†–∏—Å–ª–∏–Ω–≥ (–ø–æ–ª—É—Å—É—Ö–æ–π)', '–ì–µ–≤—é—Ä—Ü—Ç—Ä–∞–º–∏–Ω–µ—Ä', '–õ–∞–º–±–∏–∫'],
    '–ë—É—Ä–≥–µ—Ä': ['–ó–∏–Ω—Ñ–∞–Ω–¥–µ–ª—å', '–ê–º–µ—Ä–∏–∫–∞–Ω—Å–∫–∏–π IPA', '–ü–æ—Ä—Ç–µ—Ä'],
    '–î–µ—Å–µ—Ä—Ç—ã': ['–ü–æ—Ä—Ç–≤–µ–π–Ω', '–°–æ—Ç–µ—Ä–Ω', '–ú–æ—Å–∫–∞—Ç–æ'],
    '–®–æ–∫–æ–ª–∞–¥': ['–ü–æ—Ä—Ç–≤–µ–π–Ω', '–ö–∞–±–µ—Ä–Ω–µ —Å–æ–≤–∏–Ω—å–æ–Ω (–≤—ã–¥–µ—Ä–∂–∞–Ω–Ω–æ–µ)', '–†—É–±–∏–Ω–æ–≤—ã–π –ø–æ—Ä—Ç'],
    '–ö—Ä–∞—Å–Ω–æ–µ –º—è—Å–æ': ['–ö–∞–±–µ—Ä–Ω–µ —Å–æ–≤–∏–Ω—å–æ–Ω', '–°–∏—Ä–∞', '–ë–æ—Ä–¥–æ—Å–∫–∞—è —Å–º–µ—Å—å'],
    '–ë–µ–ª–æ–µ –º—è—Å–æ': ['–®–∞—Ä–¥–æ–Ω–µ', '–ü–∏–Ω–æ –ì—Ä–∏–¥–∂–∏–æ', '–í–∏–æ–Ω–∏–µ'],
    '–ú—è–≥–∫–∏–µ —Å—ã—Ä—ã': ['–°–æ–≤–∏–Ω—å–æ–Ω –ë–ª–∞–Ω', '–®–∞–±–ª–∏', '–®–µ–Ω–µ–Ω –ë–ª–∞–Ω'],
    '–¢–≤—ë—Ä–¥—ã–µ —Å—ã—Ä—ã': ['–ö–∞–±–µ—Ä–Ω–µ —Å–æ–≤–∏–Ω—å–æ–Ω', '–¢–µ–º–ø—Ä–∞–Ω–∏–ª—å–æ', '–û—Ä–∞–Ω–∂–µ–≤–æ–µ –≤–∏–Ω–æ'],
    '–ö–æ–ø—á—ë–Ω–æ—Å—Ç–∏': ['–ó–∏–Ω—Ñ–∞–Ω–¥–µ–ª—å', '–°–∏—Ä–∞', '–¢–µ–º–Ω–æ–µ –ø–∏–≤–æ'],
    '–ì—Ä–∏–ª—å': ['–®–∏—Ä–∞–∑', '–¢–µ–º–ø—Ä–∞–Ω–∏–ª—å–æ', 'IPA'],
    '–ó–∞–∫—É—Å–∫–∏': ['–ü—Ä–æ—Å–µ–∫–∫–æ', '–®–∞–º–ø–∞–Ω—Å–∫–æ–µ –ë—Ä—é—Ç', '–ê–ª—å–±–∞—Ä–∏–Ω—å–æ'],
    '–°–∞–ª–∞—Ç—ã': ['–°–æ–≤–∏–Ω—å–æ–Ω –ë–ª–∞–Ω', '–ü–∏–Ω–æ –ì—Ä–∏–¥–∂–∏–æ', '–í–µ—Ä–¥–µ—Ö–æ'],
    '–°—É–ø—ã': ['–®–∞—Ä–¥–æ–Ω–µ (–ª–µ–≥–∫–æ–µ)', '–ü–∏–Ω–æ –ù—É–∞—Ä (–∫—Ä–µ–º–æ–≤—ã–µ —Å—É–ø—ã)', '–§–∏–Ω–æ –•–µ—Ä–µ—Å'],
    '–†—ã–±–∞': ['–®–∞–±–ª–∏', '–ê–ª—å–±–∞—Ä–∏–Ω—å–æ', '–°–æ–≤–∏–Ω—å–æ–Ω –ë–ª–∞–Ω'],
    '–ö—É—Ä–∏—Ü–∞': ['–®–∞—Ä–¥–æ–Ω–µ', '–ü–∏–Ω–æ –ù—É–∞—Ä', '–ì—Ä—é–Ω–µ—Ä –í–µ–ª—å—Ç–ª–∏–Ω–µ—Ä'],
    '–°—ã—Ä': ['–®–∞–º–ø–∞–Ω—Å–∫–æ–µ', '–ü–æ—Ä—Ç–≤–µ–π–Ω', '–°–æ–≤–∏–Ω—å–æ–Ω –ë–ª–∞–Ω'],
    '–ì–æ–≤—è–¥–∏–Ω–∞': ['–ö–∞–±–µ—Ä–Ω–µ —Å–æ–≤–∏–Ω—å–æ–Ω', '–ú–∞–ª—å–±–µ–∫', '–°–∏—Ä–∞'],
    '–°–≤–∏–Ω–∏–Ω–∞': ['–†–∏—Å–ª–∏–Ω–≥ (–ø–æ–ª—É—Å—É—Ö–æ–π)', '–ü–∏–Ω–æ –ù—É–∞—Ä', '–°–∏–¥—Ä'],
    '–¢–µ–ª—è—Ç–∏–Ω–∞': ['–ü–∏–Ω–æ –ù—É–∞—Ä', '–ú–µ—Ä–ª–æ', '–ö—å—è–Ω—Ç–∏ –ö–ª–∞—Å—Å–∏–∫–æ'],
    '–£—Ç–∫–∞': ['–ü–∏–Ω–æ –ù—É–∞—Ä', '–ì–µ–≤—é—Ä—Ü—Ç—Ä–∞–º–∏–Ω–µ—Ä', '–°–∏—Ä–∞'],
    '–õ—ë–≥–∫–∏–µ –±–ª—é–¥–∞': ['–ü—Ä–æ—Å–µ–∫–∫–æ', '–ü–∏–Ω–æ –ì—Ä–∏–¥–∂–∏–æ', '–°–æ–≤–∏–Ω—å–æ–Ω –ë–ª–∞–Ω'],
    '–¢—è–∂—ë–ª—ã–µ –±–ª—é–¥–∞': ['–ö–∞–±–µ—Ä–Ω–µ —Å–æ–≤–∏–Ω—å–æ–Ω', '–°–∏—Ä–∞', '–¢–µ–º–ø—Ä–∞–Ω–∏–ª—å–æ'],
    '–ó–∞–∫—É—Å–∫–∏ –∫ –ø–∏–≤—É': ['–õ–∞–≥–µ—Ä', '–ü—à–µ–Ω–∏—á–Ω–æ–µ –ø–∏–≤–æ', 'IPA'],
    '–§—Ä—É–∫—Ç—ã': ['–ú–æ—Å–∫–∞—Ç–æ', '–†–æ—Å√©', '–°–∏–¥—Ä'],
    '–í—ã–ø–µ—á–∫–∞': ['–ú–æ—Å–∫–∞—Ç–æ', '–õ–∞–º–±—Ä—É—Å–∫–æ (–ø–æ–ª—É—Å–ª–∞–¥–∫–æ–µ)', '–°–∏–¥—Ä'],
    '–ñ–∞—Ä–µ–Ω–∞—è –µ–¥–∞': ['–ü–∏–ª—Å–Ω–µ—Ä', '–ü—Ä–æ—Å–µ–∫–∫–æ', '–®–∞—Ä–¥–æ–Ω–µ (–ª—ë–≥–∫–æ–µ)'],
    '–ö–æ–ø—á—ë–Ω–∞—è —Ä—ã–±–∞': ['–§–∏–Ω–æ –•–µ—Ä–µ—Å', '–°–æ–≤–∏–Ω—å–æ–Ω –ë–ª–∞–Ω', '–°—É—Ö–æ–π —Ä–∏—Å–ª–∏–Ω–≥'],
    '–ö–∞—Ä—Ä–∏': ['–†–∏—Å–ª–∏–Ω–≥ (–ø–æ–ª—É—Å—É—Ö–æ–π)', '–ì–µ–≤—é—Ä—Ü—Ç—Ä–∞–º–∏–Ω–µ—Ä'],
    '–ë–æ—Ä—â': ['–ü–∏–Ω–æ –ù—É–∞—Ä', '–ì–∞–º–µ', '–¢–µ–º–ø—Ä–∞–Ω–∏–ª—å–æ –º–æ–ª–æ–¥–æ–µ'],
  },

  KEYWORD_PAIRINGS: {
    spicy: ['–†–∏—Å–ª–∏–Ω–≥ (–ø–æ–ª—É—Å—É—Ö–æ–π)', '–ì–µ–≤—é—Ä—Ü—Ç—Ä–∞–º–∏–Ω–µ—Ä', '–õ–∞–º–±–∏–∫'],
    sweet: ['–ú–æ—Å–∫–∞—Ç–æ', '–ü–æ—Ä—Ç–≤–µ–π–Ω', '–°–æ—Ç–µ—Ä–Ω'],
    sour: ['–°–æ–≤–∏–Ω—å–æ–Ω –ë–ª–∞–Ω', '–ì—Ä—é–Ω–µ—Ä –í–µ–ª—å—Ç–ª–∏–Ω–µ—Ä', '–®–∞–±–ª–∏'],
    bitter: ['IPA', '–ù–µ–≥—Ä–æ–Ω–∏', '–ê–º–∞—Ä–∏'],
    salty: ['–®–∞–º–ø–∞–Ω—Å–∫–æ–µ', '–§–∏–Ω–æ –•–µ—Ä–µ—Å', '–°—É—Ö–æ–π –≤–µ—Ä–º—É—Ç'],
    umami: ['–ü–∏–Ω–æ –ù—É–∞—Ä', '–°–∏—Ä–∞', '–°–∞–∫–µ'],
    seafood: ['–®–∞–±–ª–∏', '–ê–ª—å–±–∞—Ä–∏–Ω—å–æ', '–°–æ–≤–∏–Ω—å–æ–Ω –ë–ª–∞–Ω'],
    meat: ['–ö–∞–±–µ—Ä–Ω–µ —Å–æ–≤–∏–Ω—å–æ–Ω', '–°–∏—Ä–∞', '–ú–∞–ª—å–±–µ–∫'],
    dessert: ['–ü–æ—Ä—Ç–≤–µ–π–Ω', '–ú–æ—Å–∫–∞—Ç–æ', '–°–æ—Ç–µ—Ä–Ω'],
    cheese: ['–°–æ–≤–∏–Ω—å–æ–Ω –ë–ª–∞–Ω', '–®–∞–º–ø–∞–Ω—Å–∫–æ–µ', '–ü–æ—Ä—Ç–≤–µ–π–Ω'],
    pasta: ['–ö—å—è–Ω—Ç–∏', '–í–µ—Ä–º–µ–Ω—Ç–∏–Ω–æ', '–ë–∞—Ä–±–µ—Ä–∞'],
    pizza: ['–ö—å—è–Ω—Ç–∏', '–õ–∞–º–±—Ä—É—Å–∫–æ (—Å—É—Ö–æ–µ)', '–°–∞–Ω–¥–∂–æ–≤–µ–∑–µ'],
    grill: ['–°–∏—Ä–∞', '–¢–µ–º–ø—Ä–∞–Ω–∏–ª—å–æ', '–ó–∏–Ω—Ñ–∞–Ω–¥–µ–ª—å'],
    asian: ['–†–∏—Å–ª–∏–Ω–≥ (–ø–æ–ª—É—Å—É—Ö–æ–π)', '–ì–µ–≤—é—Ä—Ü—Ç—Ä–∞–º–∏–Ω–µ—Ä', '–°–∞–∫–µ'],
    indian: ['–†–∏—Å–ª–∏–Ω–≥ (–ø–æ–ª—É—Å—É—Ö–æ–π)', '–ì–µ–≤—é—Ä—Ü—Ç—Ä–∞–º–∏–Ω–µ—Ä'],
    mexican: ['–ó–∏–Ω—Ñ–∞–Ω–¥–µ–ª—å', '–õ–∞–≥–µ—Ä', '–ú–∞—Ä–≥–∞—Ä–∏—Ç–∞'],
    japanese: ['–°–∞–∫–µ', '–†–∏—Å–ª–∏–Ω–≥ (—Å—É—Ö–æ–π)', '–°–æ–≤–∏–Ω—å–æ–Ω –ë–ª–∞–Ω'],
    barbecue: ['–ó–∏–Ω—Ñ–∞–Ω–¥–µ–ª—å', '–°–∏—Ä–∞', 'IPA'],
    smoked: ['–§–∏–Ω–æ –•–µ—Ä–µ—Å', '–°–∏—Ä–∞', '–ü–æ—Ä—Ç–µ—Ä'],
    fried: ['–ü—Ä–æ—Å–µ–∫–∫–æ', '–ü–∏–ª—Å–Ω–µ—Ä', '–®–∞—Ä–¥–æ–Ω–µ (–ª—ë–≥–∫–æ–µ)'],
    creamy: ['–®–∞—Ä–¥–æ–Ω–µ (–≤—ã–¥–µ—Ä–∂–∞–Ω–Ω–æ–µ)', '–í–∏–æ–Ω–∏–µ', '–ü–∏–Ω–æ –ù—É–∞—Ä'],
    tomato: ['–ö—å—è–Ω—Ç–∏', '–ë–∞—Ä–±–µ—Ä–∞', '–°–∞–Ω–¥–∂–æ–≤–µ–∑–µ'],
    citrus: ['–°–æ–≤–∏–Ω—å–æ–Ω –ë–ª–∞–Ω', '–ê–ª—å–±–∞—Ä–∏–Ω—å–æ', '–°—É—Ö–æ–π –≤–µ—Ä–º—É—Ç'],
    chocolate: ['–ü–æ—Ä—Ç–≤–µ–π–Ω', '–ö–∞–±–µ—Ä–Ω–µ —Å–æ–≤–∏–Ω—å–æ–Ω (–≤—ã–¥–µ—Ä–∂–∞–Ω–Ω–æ–µ)', '–ú–∞–¥–µ–π—Ä–∞'],
    berry: ['–ü–∏–Ω–æ –ù—É–∞—Ä', '–†–æ—Å√©', '–õ–∞–º–±—Ä—É—Å–∫–æ'],
    mushroom: ['–ü–∏–Ω–æ –ù—É–∞—Ä', '–®–∞—Ä–¥–æ–Ω–µ –≤—ã–¥–µ—Ä–∂–∞–Ω–Ω–æ–µ', '–ù–µ–±–±–∏–æ–ª–æ'],
  },

  CATEGORY_PAIRINGS: {
    meat: ['–ö–∞–±–µ—Ä–Ω–µ —Å–æ–≤–∏–Ω—å–æ–Ω', '–°–∏—Ä–∞', '–ú–∞–ª—å–±–µ–∫'],
    fish: ['–®–∞–±–ª–∏', '–°–æ–≤–∏–Ω—å–æ–Ω –ë–ª–∞–Ω', '–ê–ª—å–±–∞—Ä–∏–Ω—å–æ'],
    spicy: ['–†–∏—Å–ª–∏–Ω–≥ (–ø–æ–ª—É—Å—É—Ö–æ–π)', '–ì–µ–≤—é—Ä—Ü—Ç—Ä–∞–º–∏–Ω–µ—Ä'],
    creamy: ['–®–∞—Ä–¥–æ–Ω–µ (–≤—ã–¥–µ—Ä–∂–∞–Ω–Ω–æ–µ)', '–í–∏–æ–Ω–∏–µ', '–ü–∏–Ω–æ –ù—É–∞—Ä'],
    fried: ['–ü—Ä–æ—Å–µ–∫–∫–æ', '–ü–∏–ª—Å–Ω–µ—Ä'],
    sweet: ['–ü–æ—Ä—Ç–≤–µ–π–Ω', '–ú–æ—Å–∫–∞—Ç–æ'],
    light: ['–ü–∏–Ω–æ –ì—Ä–∏–¥–∂–∏–æ', '–°–æ–≤–∏–Ω—å–æ–Ω –ë–ª–∞–Ω'],
    heavy: ['–ö–∞–±–µ—Ä–Ω–µ —Å–æ–≤–∏–Ω—å–æ–Ω', '–¢–µ–º–ø—Ä–∞–Ω–∏–ª—å–æ', '–°–∏—Ä–∞'],
    cheese: ['–®–∞–º–ø–∞–Ω—Å–∫–æ–µ', '–ü–æ—Ä—Ç–≤–µ–π–Ω', '–°–æ–≤–∏–Ω—å–æ–Ω –ë–ª–∞–Ω'],
    vegetables: ['–°–æ–≤–∏–Ω—å–æ–Ω –ë–ª–∞–Ω', '–í–µ—Ä–¥–µ—Ö–æ', '–ì—Ä—é–Ω–µ—Ä –í–µ–ª—å—Ç–ª–∏–Ω–µ—Ä'],
    grill: ['–°–∏—Ä–∞', '–ó–∏–Ω—Ñ–∞–Ω–¥–µ–ª—å', '–¢–µ–º–ø—Ä–∞–Ω–∏–ª—å–æ'],
    dessert: ['–°–æ—Ç–µ—Ä–Ω', '–ú–æ—Å–∫–∞—Ç–æ', '–ü–æ—Ä—Ç–≤–µ–π–Ω'],
  }
};

// –ì–ª–æ–±–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö
let allMeals = [];
let allProducts = [];
let lastRecommendedDrinks = new Set(); // –î–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –ø–æ—Å–ª–µ–¥–Ω–∏—Ö —Ä–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞–Ω–Ω—ã—Ö –Ω–∞–ø–∏—Ç–∫–æ–≤
let drinkUsageCount = new Map(); // –î–ª—è –ø–æ–¥—Å—á–µ—Ç–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –Ω–∞–ø–∏—Ç–∫–æ–≤
let fixedDrinkSets = new Map(); // –î–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –Ω–∞–±–æ—Ä–æ–≤ –Ω–∞–ø–∏—Ç–∫–æ–≤ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –±–ª—é–¥–∞

// –†–ê–°–®–ò–†–ï–ù–ù–ê–Ø –æ–Ω—Ç–æ–ª–æ–≥–∏—á–µ—Å–∫–∞—è –º–æ–¥–µ–ª—å —Å–æ—á–µ—Ç–∞–Ω–∏–π —Å –±–æ–ª—å—à–∏–º —Ä–∞–∑–Ω–æ–æ–±—Ä–∞–∑–∏–µ–º
const flavorProfiles = {
    // –ö–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ –±–ª—é–¥–∞ -> –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ –Ω–∞–ø–∏—Ç–∫–∏ (—É–Ω–∏–∫–∞–ª—å–Ω—ã–µ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –±–ª—é–¥–∞)
    exactMatches: REAL_PAIRINGS,

    // –ö–∞—Ç–µ–≥–æ—Ä–∏–∏ –±–ª—é–¥ –∏ –∏—Ö –æ–±—â–∏–µ —Å–æ—á–µ—Ç–∞–Ω–∏—è (—É–Ω–∏–∫–∞–ª—å–Ω—ã–µ –¥–ª—è –∫–∞–∂–¥–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏)
    categoryPairs: CATEGORY_PAIRINGS,

    // –ö–ª—é—á–µ–≤—ã–µ —Å–ª–æ–≤–∞ –≤ –æ–ø–∏—Å–∞–Ω–∏—è—Ö (—É–Ω–∏–∫–∞–ª—å–Ω—ã–µ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Ç–∏–ø–∞)
    keywordPairs: KEYWORD_PAIRINGS
};

// –§—É–Ω–∫—Ü–∏—è –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ —Ö—ç—à–∞ –Ω–∞ –æ—Å–Ω–æ–≤–µ –Ω–∞–∑–≤–∞–Ω–∏—è –±–ª—é–¥–∞
function getFixedHashForMeal(mealName, seed = 42) {
    let hash = 0;
    for (let i = 0; i < mealName.length; i++) {
        hash = ((hash << 5) - hash) + mealName.charCodeAt(i);
        hash = hash & hash; // –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –≤ 32-–±–∏—Ç–Ω–æ–µ —Ü–µ–ª–æ–µ
    }
    // –ò—Å–ø–æ–ª—å–∑—É–µ–º seed –¥–ª—è –¥–µ—Ç–µ—Ä–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞
    return Math.abs((hash * seed) % 1000);
}

// –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è —Å–µ–∫—Ü–∏–π
function showSection(sectionName) {
    // –°–∫—Ä—ã–≤–∞–µ–º –≤—Å–µ —Å–µ–∫—Ü–∏–∏
    document.getElementById('main-section').style.display = 'none';
    document.getElementById('catalog-section').classList.remove('active');
    document.getElementById('about-section').classList.remove('active');
    
    // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –≤—ã–±—Ä–∞–Ω–Ω—É—é —Å–µ–∫—Ü–∏—é
    if (sectionName === 'main') {
        document.getElementById('main-section').style.display = 'block';
    } else if (sectionName === 'catalog') {
        document.getElementById('catalog-section').classList.add('active');
        displayCatalog();
    } else if (sectionName === 'about') {
        document.getElementById('about-section').classList.add('active');
    }
}

// –§—É–Ω–∫—Ü–∏—è –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –∫–∞—Ç–∞–ª–æ–≥–∞
function displayCatalog() {
    const catalogGrid = document.getElementById('catalog-grid');
    const catalogFilters = document.getElementById('catalog-filters');
    
    // –û—á–∏—â–∞–µ–º —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ
    catalogGrid.innerHTML = '';
    catalogFilters.innerHTML = '';
    
    // –ü–æ–ª—É—á–∞–µ–º —É–Ω–∏–∫–∞–ª—å–Ω—ã–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
    const categories = [...new Set(allMeals.map(meal => meal.category))].filter(Boolean);
    
    // –°–æ–∑–¥–∞–µ–º –∫–Ω–æ–ø–∫–∏ —Ñ–∏–ª—å—Ç—Ä–æ–≤
    const allFilter = document.createElement('button');
    allFilter.className = 'filter-btn active';
    allFilter.textContent = '–í—Å–µ –±–ª—é–¥–∞';
    allFilter.onclick = () => filterCatalog('all');
    catalogFilters.appendChild(allFilter);
    
    categories.forEach(category => {
        const filterBtn = document.createElement('button');
        filterBtn.className = 'filter-btn';
        filterBtn.textContent = category;
        filterBtn.onclick = () => filterCatalog(category);
        catalogFilters.appendChild(filterBtn);
    });
    
    // –û—Ç–æ–±—Ä–∞–∂–∞–µ–º –≤—Å–µ –±–ª—é–¥–∞
    displayMealsInCatalog(allMeals);
}

// –§—É–Ω–∫—Ü–∏—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ –∫–∞—Ç–∞–ª–æ–≥–∞
function filterCatalog(category) {
    // –û–±–Ω–æ–≤–ª—è–µ–º –∞–∫—Ç–∏–≤–Ω—É—é –∫–Ω–æ–ø–∫—É
    document.querySelectorAll('.filter-btn').forEach(btn => {
        btn.classList.remove('active');
    });
    event.target.classList.add('active');
    
    const filteredMeals = category === 'all' 
        ? allMeals 
        : allMeals.filter(meal => meal.category === category);
    
    displayMealsInCatalog(filteredMeals);
}

// –§—É–Ω–∫—Ü–∏—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –±–ª—é–¥ –≤ –∫–∞—Ç–∞–ª–æ–≥–µ
function displayMealsInCatalog(meals) {
    const catalogGrid = document.getElementById('catalog-grid');
    catalogGrid.innerHTML = '';
    
    if (meals.length === 0) {
        catalogGrid.innerHTML = `
            <div style="grid-column: 1 / -1; text-align: center; padding: 40px; color: var(--text-secondary);">
                <p>–ë–ª—é–¥–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω—ã.</p>
            </div>
        `;
        return;
    }
    
    meals.forEach(meal => {
        const card = document.createElement('div');
        card.className = 'card';
        
        // –°–æ–∑–¥–∞–µ–º –±–µ–∑–æ–ø–∞—Å–Ω—É—é —Å—Ç—Ä–æ–∫—É –¥–ª—è –ø–µ—Ä–µ–¥–∞—á–∏ –¥–∞–Ω–Ω—ã—Ö
        const mealData = JSON.stringify(meal).replace(/"/g, '&quot;');
        
        card.innerHTML = `
            <div class="card-image">
                ${meal.image || meal.imageUrl ? 
                    `<img src="${meal.image || meal.imageUrl}" alt="${meal.name}" 
                          onerror="this.style.display='none'; 
                                   this.parentNode.innerHTML='üçΩÔ∏è'; 
                                   this.parentNode.style.display='flex'; 
                                   this.parentNode.style.alignItems='center'; 
                                   this.parentNode.style.justifyContent='center'; 
                                   this.parentNode.style.fontSize='48px';">` : 
                    'üçΩÔ∏è'
                }
            </div>
            <div class="card-content">
                <div class="card-type">${meal.category || '–ë–ª—é–¥–æ'}</div>
                <h3 class="card-title">${meal.name || '–ë–µ–∑ –Ω–∞–∑–≤–∞–Ω–∏—è'}</h3>
                <div class="card-actions">
                    <button class="btn btn-primary" onclick="selectMealFromCatalog(${mealData})">
                        –ü–æ–¥–æ–±—Ä–∞—Ç—å –Ω–∞–ø–∏—Ç–∫–∏
                    </button>
                </div>
            </div>
        `;
        
        catalogGrid.appendChild(card);
    });
}

// –§—É–Ω–∫—Ü–∏—è –≤—ã–±–æ—Ä–∞ –±–ª—é–¥–∞ –∏–∑ –∫–∞—Ç–∞–ª–æ–≥–∞
function selectMealFromCatalog(meal) {
    showSection('main');
    // –ó–∞–ø–æ–ª–Ω—è–µ–º –ø–æ–ª–µ –ø–æ–∏—Å–∫–∞ –Ω–∞–∑–≤–∞–Ω–∏–µ–º –±–ª—é–¥–∞
    document.getElementById('meal-search').value = meal.name;
    // –í—ã–±–∏—Ä–∞–µ–º –±–ª—é–¥–æ
    selectMeal(meal);
    // –ü—Ä–æ–∫—Ä—É—á–∏–≤–∞–µ–º –∫ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º
    document.getElementById('recommendations').scrollIntoView({ behavior: 'smooth' });
}

// –§—É–Ω–∫—Ü–∏—è –æ—Ç–∫—Ä—ã—Ç–∏—è –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞ —Å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –æ –Ω–∞–ø–∏—Ç–∫–µ
function openDrinkModal(product) {
    console.log('Opening modal for product:', product);
    
    const modal = document.getElementById('drink-modal');
    
    // –ó–∞–ø–æ–ª–Ω—è–µ–º –¥–∞–Ω–Ω—ã–µ –æ –Ω–∞–ø–∏—Ç–∫–µ
    document.getElementById('modal-drink-name').textContent = product.name || '–ë–µ–∑ –Ω–∞–∑–≤–∞–Ω–∏—è';
    document.getElementById('modal-drink-description').textContent = product.description || '–û–ø–∏—Å–∞–Ω–∏–µ –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç';
    document.getElementById('modal-drink-volume').textContent = product.volume || '–ù–µ —É–∫–∞–∑–∞–Ω';
    document.getElementById('modal-drink-strength').textContent = product.strength || '–ù–µ —É–∫–∞–∑–∞–Ω–∞';
    document.getElementById('modal-drink-country').textContent = product.country || '–ù–µ —É–∫–∞–∑–∞–Ω–∞';
    document.getElementById('modal-drink-type').textContent = getProductType(product.category);
    document.getElementById('modal-drink-price').textContent = product.price ? `${product.price} ‚ÇΩ` : '–¶–µ–Ω–∞ –Ω–µ —É–∫–∞–∑–∞–Ω–∞';
    document.getElementById('modal-drink-pairing').textContent = product.recommendedDishes || '–†–∞–∑–ª–∏—á–Ω—ã–µ –±–ª—é–¥–∞';
    
    const modalImage = document.getElementById('modal-drink-image');
    if (product.image || product.imageUrl) {
        modalImage.innerHTML = `<img src="${product.image || product.imageUrl}" alt="${product.name}" 
            onerror="this.style.display='none'; 
                     this.parentNode.innerHTML='${getDrinkEmoji(product.category)}'; 
                     this.parentNode.style.display='flex'; 
                     this.parentNode.style.alignItems='center'; 
                     this.parentNode.style.justifyContent='center'; 
                     this.parentNode.style.fontSize='72px';">`;
    } else {
        modalImage.innerHTML = getDrinkEmoji(product.category);
        modalImage.style.display = 'flex';
        modalImage.style.alignItems = 'center';
        modalImage.style.justifyContent = 'center';
        modalImage.style.fontSize = '72px';
    }
    
    modal.classList.add('active');
}

// –§—É–Ω–∫—Ü–∏—è –∑–∞–∫—Ä—ã—Ç–∏—è –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞
function closeModal() {
    document.getElementById('drink-modal').classList.remove('active');
}

// –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
function getProductType(category) {
    const types = {
        'wine': '–í–∏–Ω–æ',
        'beer': '–ü–∏–≤–æ',
        'whiskey': '–í–∏—Å–∫–∏',
        'vodka': '–í–æ–¥–∫–∞',
        'rum': '–†–æ–º',
        'vermouth': '–í–µ—Ä–º—É—Ç',
        'cognac': '–ö–æ–Ω—å—è–∫',
        'liquor': '–õ–∏–∫—ë—Ä',
        'sparkling': '–ò–≥—Ä–∏—Å—Ç–æ–µ',
        'coffee': '–ö–æ—Ñ–µ',
        'tea': '–ß–∞–π',
        'juice': '–°–æ–∫',
        'sake': '–°–∞–∫–µ',
        'tequila': '–¢–µ–∫–∏–ª–∞',
        'brandy': '–ë—Ä–µ–Ω–¥–∏',
        'absinthe': '–ê–±—Å–µ–Ω—Ç',
        'gin': '–î–∂–∏–Ω'
    };
    return types[category] || '–ù–∞–ø–∏—Ç–æ–∫';
}

function getDrinkEmoji(category) {
    const emojis = {
        'wine': 'üç∑',
        'beer': 'üç∫',
        'whiskey': 'ü•É',
        'vodka': 'üç∏',
        'rum': 'üçπ',
        'vermouth': 'üç∑',
        'cognac': 'ü•É',
        'liquor': 'ü•Ç',
        'sparkling': 'ü•Ç',
        'coffee': '‚òï',
        'tea': 'üçµ',
        'juice': 'üßÉ',
        'sake': 'üç∂',
        'tequila': 'üç∏',
        'brandy': 'ü•É',
        'absinthe': 'üç∏',
        'gin': 'üç∏'
    };
    return emojis[category] || 'ü•§';
}

// –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø –ø–æ–¥—Å—á–µ—Ç–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –Ω–∞–ø–∏—Ç–∫–æ–≤
function initializeDrinkUsage() {
    // –°–±—Ä–∞—Å—ã–≤–∞–µ–º —Å—á–µ—Ç—á–∏–∫–∏
    drinkUsageCount = new Map();
    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º –≤—Å–µ –Ω–∞–ø–∏—Ç–∫–∏ —Å –Ω—É–ª–µ–≤—ã–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º
    allProducts.forEach(product => {
        const drinkKey = (product.name || '').toLowerCase();
        if (drinkKey) {
            drinkUsageCount.set(drinkKey, 0);
        }
    });
}

// –§–£–ù–ö–¶–ò–Ø –ü–û–î–ë–û–†–ê –ù–ê–ü–ò–¢–ö–û–í –° –§–ò–ö–°–ò–†–û–í–ê–ù–ù–´–ú–ò –ù–ê–ë–û–†–ê–ú–ò (2-3 –Ω–∞–ø–∏—Ç–∫–∞)
function findDrinksForMeal(meal) {
    const mealName = meal.name.toLowerCase();
    const mealDescription = (meal.description || '').toLowerCase();
    const mealCategory = (meal.category || '').toLowerCase();
    
    console.log('–ü–æ–∏—Å–∫ —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –Ω–∞–ø–∏—Ç–∫–æ–≤ –¥–ª—è:', mealName);
    
    // –®–∞–≥ 1: –°–æ–∑–¥–∞–µ–º —É–Ω–∏–∫–∞–ª—å–Ω—ã–π —Ö—ç—à –¥–ª—è –±–ª—é–¥–∞ (–¥–µ—Ç–µ—Ä–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–π)
    const mealHash = getFixedHashForMeal(mealName);
    
    // –®–∞–≥ 2: –ü–æ–ª—É—á–∞–µ–º –í–°–ï –≤–æ–∑–º–æ–∂–Ω—ã–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –æ–Ω—Ç–æ–ª–æ–≥–∏–∏
    const allPossibleDrinks = new Set();
    
    // 1. –¢–æ—á–Ω—ã–µ —Å–æ–≤–ø–∞–¥–µ–Ω–∏—è –∏–∑ REAL_PAIRINGS
    for (const [dishName, drinks] of Object.entries(REAL_PAIRINGS)) {
        if (mealName.includes(dishName) || dishName.includes(mealName)) {
            drinks.forEach(drink => allPossibleDrinks.add(drink.toLowerCase()));
        }
    }
    
    // 2. –°–æ–≤–ø–∞–¥–µ–Ω–∏—è –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
    if (CATEGORY_PAIRINGS[mealCategory]) {
        CATEGORY_PAIRINGS[mealCategory].forEach(drink => {
            allPossibleDrinks.add(drink.toLowerCase());
        });
    }
    
    // 3. –°–æ–≤–ø–∞–¥–µ–Ω–∏—è –ø–æ –∫–ª—é—á–µ–≤—ã–º —Å–ª–æ–≤–∞–º
    for (const [keyword, drinks] of Object.entries(KEYWORD_PAIRINGS)) {
        if (mealDescription.includes(keyword) || mealName.includes(keyword)) {
            drinks.forEach(drink => allPossibleDrinks.add(drink.toLowerCase()));
        }
    }
    
    console.log('–í—Å–µ –≤–æ–∑–º–æ–∂–Ω—ã–µ –Ω–∞–ø–∏—Ç–∫–∏ –ø–æ –æ–Ω—Ç–æ–ª–æ–≥–∏–∏:', Array.from(allPossibleDrinks));
    
    // –®–∞–≥ 3: –ò—â–µ–º –Ω–∞–ø–∏—Ç–∫–∏ –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö, –∫–æ—Ç–æ—Ä—ã–µ —Å–æ–≤–ø–∞–¥–∞—é—Ç —Å —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è–º–∏
    const matchingProducts = [];
    
    allPossibleDrinks.forEach(drinkName => {
        // –ò—â–µ–º –≤—Å–µ –Ω–∞–ø–∏—Ç–∫–∏, –∫–æ—Ç–æ—Ä—ã–µ —Å–æ–¥–µ—Ä–∂–∞—Ç —ç—Ç–æ –Ω–∞–∑–≤–∞–Ω–∏–µ
        const foundProducts = allProducts.filter(product => {
            const productName = (product.name || '').toLowerCase();
            const productCategory = (product.category || '').toLowerCase();
            const productDescription = (product.description || '').toLowerCase();
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ —Å –Ω–∞–∑–≤–∞–Ω–∏–µ–º –Ω–∞–ø–∏—Ç–∫–∞
            return productName.includes(drinkName) || 
                   drinkName.includes(productName) ||
                   productCategory.includes(drinkName) ||
                   productDescription.includes(drinkName);
        });
        
        matchingProducts.push(...foundProducts);
    });
    
    console.log('–ù–∞–π–¥–µ–Ω–æ —Å–æ–≤–ø–∞–¥–∞—é—â–∏—Ö –Ω–∞–ø–∏—Ç–∫–æ–≤:', matchingProducts.length);
    
    // –®–∞–≥ 4: –í—ã–±–∏—Ä–∞–µ–º —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –Ω–∞–±–æ—Ä –∏–∑ 2-3 –Ω–∞–ø–∏—Ç–∫–æ–≤ –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ö—ç—à–∞
    let selectedProducts = [];
    
    if (matchingProducts.length > 0) {
        // –°–æ—Ä—Ç–∏—Ä—É–µ–º –¥–ª—è –¥–µ—Ç–µ—Ä–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –≤—ã–±–æ—Ä–∞
        matchingProducts.sort((a, b) => {
            return (a.name || '').localeCompare(b.name || '');
        });
        
        // –í—ã–±–∏—Ä–∞–µ–º 2 –∏–ª–∏ 3 –Ω–∞–ø–∏—Ç–∫–∞ –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ö—ç—à–∞ (—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–æ –¥–ª—è –±–ª—é–¥–∞)
        const numDrinks = 2 + (mealHash % 2); // 2 –∏–ª–∏ 3 –Ω–∞–ø–∏—Ç–∫–∞ (—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–æ –¥–ª—è –±–ª—é–¥–∞)
        const startIndex = mealHash % Math.max(1, matchingProducts.length - numDrinks);
        
        // –ë–µ—Ä–µ–º —É–Ω–∏–∫–∞–ª—å–Ω—ã–µ –Ω–∞–ø–∏—Ç–∫–∏
        const selectedNames = new Set();
        for (let i = startIndex; i < matchingProducts.length && selectedProducts.length < numDrinks; i++) {
            const product = matchingProducts[i];
            const productName = (product.name || '').toLowerCase();
            
            if (!selectedNames.has(productName)) {
                selectedProducts.push(product);
                selectedNames.add(productName);
            }
        }
        
        // –ï—Å–ª–∏ –Ω–µ –Ω–∞–±—Ä–∞–ª–∏ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –Ω–∞–ø–∏—Ç–∫–æ–≤
        if (selectedProducts.length < numDrinks) {
            // –î–æ–±–∞–≤–ª—è–µ–º –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –Ω–∞–ø–∏—Ç–∫–∏
            for (const product of matchingProducts) {
                if (selectedProducts.length >= numDrinks) break;
                
                const productName = (product.name || '').toLowerCase();
                if (!selectedNames.has(productName)) {
                    selectedProducts.push(product);
                    selectedNames.add(productName);
                }
            }
        }
    }
    
    // –®–∞–≥ 5: –ï—Å–ª–∏ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–π –º–∞–ª–æ –∏–ª–∏ –Ω–µ—Ç, –±–µ—Ä–µ–º –ø–æ–¥—Ö–æ–¥—è—â–∏–µ –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
    if (selectedProducts.length < 2) {
        // –ò—â–µ–º –Ω–∞–ø–∏—Ç–∫–∏ –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –±–ª—é–¥–∞
        let alternativeProducts = allProducts.filter(product => {
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –µ—Å—Ç—å –ª–∏ —É –Ω–∞–ø–∏—Ç–∫–∞ –∫–∞—Ç–µ–≥–æ—Ä–∏—è, –ø–æ–¥—Ö–æ–¥—è—â–∞—è –∫ –±–ª—é–¥—É
            const productCategory = (product.category || '').toLowerCase();
            const productName = (product.name || '').toLowerCase();
            
            // –ü—Ä–æ–ø—É—Å–∫–∞–µ–º —É–∂–µ –≤—ã–±—Ä–∞–Ω–Ω—ã–µ
            const alreadySelected = selectedProducts.some(p => 
                (p.name || '').toLowerCase() === productName
            );
            
            return !alreadySelected;
        });
        
        // –°–æ—Ä—Ç–∏—Ä—É–µ–º –¥–ª—è –¥–µ—Ç–µ—Ä–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –≤—ã–±–æ—Ä–∞
        alternativeProducts.sort((a, b) => {
            return (a.name || '').localeCompare(b.name || '');
        });
        
        // –î–æ–ø–æ–ª–Ω—è–µ–º –¥–æ 2-3 –Ω–∞–ø–∏—Ç–∫–æ–≤ (–∏—Å–ø–æ–ª—å–∑—É–µ–º —Ç–æ—Ç –∂–µ mealHash –¥–ª—è —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω–æ—Å—Ç–∏)
        const numNeeded = 2 + (mealHash % 2) - selectedProducts.length;
        const altStartIndex = mealHash % Math.max(1, alternativeProducts.length - numNeeded);
        
        for (let i = altStartIndex; i < alternativeProducts.length && selectedProducts.length < (2 + (mealHash % 2)); i++) {
            const product = alternativeProducts[i];
            const productName = (product.name || '').toLowerCase();
            const alreadySelected = selectedProducts.some(p => 
                (p.name || '').toLowerCase() === productName
            );
            
            if (!alreadySelected) {
                selectedProducts.push(product);
            }
        }
    }
    
    // –®–∞–≥ 6: –ï—Å–ª–∏ –≤—Å–µ –µ—â–µ –º–∞–ª–æ –Ω–∞–ø–∏—Ç–∫–æ–≤, –¥–æ–±–∞–≤–ª—è–µ–º –ª—é–±—ã–µ —É–Ω–∏–∫–∞–ª—å–Ω—ã–µ
    if (selectedProducts.length < 2) {
        // –î–æ–±–∞–≤–ª—è–µ–º –ª—é–±—ã–µ —É–Ω–∏–∫–∞–ª—å–Ω—ã–µ –Ω–∞–ø–∏—Ç–∫–∏ –∏–∑ –±–∞–∑—ã
        for (const product of allProducts) {
            if (selectedProducts.length >= 2 + (mealHash % 2)) break;
            
            const productName = (product.name || '').toLowerCase();
            const alreadySelected = selectedProducts.some(p => 
                (p.name || '').toLowerCase() === productName
            );
            
            if (!alreadySelected) {
                selectedProducts.push(product);
            }
        }
    }
    
    console.log(`–§–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –Ω–∞–±–æ—Ä –∏–∑ ${selectedProducts.length} –Ω–∞–ø–∏—Ç–∫–æ–≤ –¥–ª—è "${mealName}":`, selectedProducts.map(p => p.name));
    
    // –°–æ—Ö—Ä–∞–Ω—è–µ–º —ç—Ç–æ—Ç –Ω–∞–±–æ—Ä –¥–ª—è –¥–∞–Ω–Ω–æ–≥–æ –±–ª—é–¥–∞
    fixedDrinkSets.set(mealName, selectedProducts);
    
    return selectedProducts;
}

// –î–æ–∫—É–º–µ–Ω—Ç –∑–∞–≥—Ä—É–∂–µ–Ω
document.addEventListener('DOMContentLoaded', function() {
    const searchBtn = document.getElementById('search-btn');
    const mealSearch = document.getElementById('meal-search');
    const searchSuggestions = document.getElementById('search-suggestions');
    const loading = document.getElementById('loading');
    const drinkCards = document.getElementById('drink-cards');
    const popularDishes = document.getElementById('popular-dishes');
    const errorMessage = document.getElementById('error-message');
    const selectedMealInfo = document.getElementById('selected-meal-info');
    
    const PRODUCTS_API = 'https://6925ffcd82b59600d725f256.mockapi.io/v1/products';
    const MEALS_API = 'https://6925ffcd82b59600d725f256.mockapi.io/v1/meals';
    
    // –ó–∞–≥—Ä—É–∑–∫–∞ –≤—Å–µ—Ö –¥–∞–Ω–Ω—ã—Ö
    async function loadAllData() {
        try {
            loading.style.display = 'block';
            errorMessage.style.display = 'none';
            
            console.log('–ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö...');
            
            // –ó–∞–≥—Ä—É–∂–∞–µ–º –±–ª—é–¥–∞ –∏ –Ω–∞–ø–∏—Ç–∫–∏ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ
            const [mealsResponse, productsResponse] = await Promise.all([
                fetch(MEALS_API),
                fetch(PRODUCTS_API)
            ]);
            
            if (!mealsResponse.ok) throw new Error(`–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –±–ª—é–¥: ${mealsResponse.status}`);
            if (!productsResponse.ok) throw new Error(`–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –Ω–∞–ø–∏—Ç–∫–æ–≤: ${productsResponse.status}`);
            
            allMeals = await mealsResponse.json();
            allProducts = await productsResponse.json();
            
            console.log('–ë–ª—é–¥–∞ –∑–∞–≥—Ä—É–∂–µ–Ω—ã:', allMeals.length);
            console.log('–ù–∞–ø–∏—Ç–∫–∏ –∑–∞–≥—Ä—É–∂–µ–Ω—ã:', allProducts.length);
            
            // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º —Å—á–µ—Ç—á–∏–∫–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –Ω–∞–ø–∏—Ç–∫–æ–≤
            initializeDrinkUsage();
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –ø–æ–ø—É–ª—è—Ä–Ω—ã–µ –±–ª—é–¥–∞
            displayPopularDishes();
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Ç–æ–ª—å–∫–æ –ø–µ—Ä–≤—ã–µ 6 –Ω–∞–ø–∏—Ç–∫–æ–≤ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
            displayProducts(allProducts.slice(0, 6));
            
        } catch (error) {
            console.error('Error loading data:', error);
            errorMessage.style.display = 'block';
            errorMessage.textContent = `–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö: ${error.message}. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç—É.`;
        } finally {
            loading.style.display = 'none';
        }
    }
    
    // –ü–æ–∫–∞–∑ –ø–æ–ø—É–ª—è—Ä–Ω—ã—Ö –±–ª—é–¥
    function displayPopularDishes() {
        popularDishes.innerHTML = '';
        
        // –ë–µ—Ä–µ–º –ø–µ—Ä–≤—ã–µ 8 –±–ª—é–¥ –¥–ª—è –ø–æ–∫–∞–∑–∞
        const popularMeals = allMeals.slice(0, 8);
        
        popularMeals.forEach(meal => {
            const dishTag = document.createElement('div');
            dishTag.className = 'dish-tag';
            dishTag.textContent = meal.name;
            dishTag.addEventListener('click', () => {
                selectMeal(meal);
            });
            popularDishes.appendChild(dishTag);
        });
    }
    
    // –í—ã–±–æ—Ä –±–ª—é–¥–∞
    function selectMeal(meal) {
        // –ó–∞–ø–æ–ª–Ω—è–µ–º –ø–æ–ª–µ –ø–æ–∏—Å–∫–∞
        mealSearch.value = meal.name;
        
        // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –±–ª—é–¥–µ
        document.getElementById('selected-meal-name').textContent = meal.name;
        document.getElementById('selected-meal-description').textContent = 
            meal.description || '–í–∫—É—Å–Ω–æ–µ –±–ª—é–¥–æ –¥–ª—è –∏–¥–µ–∞–ª—å–Ω–æ–≥–æ —É–∂–∏–Ω–∞';
        
        const mealImage = document.getElementById('selected-meal-image');
        if (meal.image || meal.imageUrl) {
            mealImage.innerHTML = `<img src="${meal.image || meal.imageUrl}" alt="${meal.name}">`;
        } else {
            mealImage.innerHTML = 'üçΩÔ∏è';
            mealImage.style.display = 'flex';
            mealImage.style.alignItems = 'center';
            mealImage.style.justifyContent = 'center';
            mealImage.style.fontSize = '24px';
        }
        
        selectedMealInfo.classList.add('active');
        
        // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –µ—Å—Ç—å –ª–∏ —É–∂–µ —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –Ω–∞–±–æ—Ä –¥–ª—è —ç—Ç–æ–≥–æ –±–ª—é–¥–∞
        const mealName = meal.name.toLowerCase();
        let recommendedDrinks;
        
        if (fixedDrinkSets.has(mealName)) {
            // –ò—Å–ø–æ–ª—å–∑—É–µ–º —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã–π —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –Ω–∞–±–æ—Ä
            recommendedDrinks = fixedDrinkSets.get(mealName);
            console.log('–ò—Å–ø–æ–ª—å–∑—É–µ–º —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã–π —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –Ω–∞–±–æ—Ä –¥–ª—è', mealName);
        } else {
            // –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º –Ω–æ–≤—ã–π —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –Ω–∞–±–æ—Ä
            recommendedDrinks = findDrinksForMeal(meal);
        }
        
        displayProducts(recommendedDrinks);
        
        document.querySelector('.section-title').textContent = 
            `–ò–¥–µ–∞–ª—å–Ω—ã–µ –Ω–∞–ø–∏—Ç–∫–∏ –¥–ª—è "${meal.name}" (${recommendedDrinks.length} –Ω–∞–π–¥–µ–Ω–æ)`;
    }
    
    // –ê–≤—Ç–æ–¥–æ–ø–æ–ª–Ω–µ–Ω–∏–µ –ø—Ä–∏ –≤–≤–æ–¥–µ
    mealSearch.addEventListener('input', function() {
        const query = this.value.toLowerCase().trim();
        searchSuggestions.innerHTML = '';
        
        if (query.length < 2) {
            searchSuggestions.style.display = 'none';
            return;
        }
        
        const filteredMeals = allMeals.filter(meal => 
            meal.name.toLowerCase().includes(query)
        ).slice(0, 5);
        
        if (filteredMeals.length > 0) {
            filteredMeals.forEach(meal => {
                const suggestion = document.createElement('div');
                suggestion.className = 'suggestion-item';
                suggestion.textContent = meal.name;
                suggestion.addEventListener('click', () => {
                    selectMeal(meal);
                    searchSuggestions.style.display = 'none';
                });
                searchSuggestions.appendChild(suggestion);
            });
            searchSuggestions.style.display = 'block';
        } else {
            searchSuggestions.style.display = 'none';
        }
    });
    
    // –°–∫—Ä—ã–≤–∞–µ–º suggestions –ø—Ä–∏ –∫–ª–∏–∫–µ –≤–Ω–µ
    document.addEventListener('click', function(e) {
        if (!mealSearch.contains(e.target) && !searchSuggestions.contains(e.target)) {
            searchSuggestions.style.display = 'none';
        }
    });
    
    // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –∫–∞—Ä—Ç–æ—á–µ–∫ –ø—Ä–æ–¥—É–∫—Ç–æ–≤
    function displayProducts(products) {
        drinkCards.innerHTML = '';
        
        if (products.length === 0) {
            drinkCards.innerHTML = `
                <div style="grid-column: 1 / -1; text-align: center; padding: 40px; color: var(--text-secondary);">
                    <p>–ö —Å–æ–∂–∞–ª–µ–Ω–∏—é, –ø–æ–¥—Ö–æ–¥—è—â–∏–µ –Ω–∞–ø–∏—Ç–∫–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω—ã.</p>
                    <p>–ü–æ–ø—Ä–æ–±—É–π—Ç–µ –≤—ã–±—Ä–∞—Ç—å –¥—Ä—É–≥–æ–µ –±–ª—é–¥–æ.</p>
                </div>
            `;
            return;
        }
        
        products.forEach(product => {
            const card = document.createElement('div');
            card.className = 'card';
            
            const productType = getProductType(product.category);
            const productPrice = product.price ? `${product.price} ‚ÇΩ` : '–¶–µ–Ω–∞ –Ω–µ —É–∫–∞–∑–∞–Ω–∞';
            const inStock = product.inStock !== false;
            
            // –°–æ–∑–¥–∞–µ–º –±–µ–∑–æ–ø–∞—Å–Ω—É—é —Å—Ç—Ä–æ–∫—É JSON –¥–ª—è –ø–µ—Ä–µ–¥–∞—á–∏ –≤ —Ñ—É–Ω–∫—Ü–∏—é
            const productData = JSON.stringify(product).replace(/"/g, '&quot;');
            
            card.innerHTML = `
                <div class="card-image">
                    ${product.image || product.imageUrl ? 
                        `<img src="${product.image || product.imageUrl}" alt="${product.name}" 
                              onerror="this.style.display='none'; 
                                       this.parentNode.innerHTML='${getDrinkEmoji(product.category)}'; 
                                       this.parentNode.style.display='flex'; 
                                       this.parentNode.style.alignItems='center'; 
                                       this.parentNode.style.justifyContent='center'; 
                                       this.parentNode.style.fontSize='48px';">` : 
                        getDrinkEmoji(product.category)
                    }
                </div>
                <div class="card-content">
                    <div class="card-type">${productType}</div>
                    <h3 class="card-title">${product.name || '–ë–µ–∑ –Ω–∞–∑–≤–∞–Ω–∏—è'}</h3>
                    <div class="card-price">${productPrice}</div>
                    <div class="card-actions">
                        <span class="availability ${inStock ? '' : 'out-of-stock'}">
                            ${inStock ? '‚úì –í –Ω–∞–ª–∏—á–∏–∏' : '‚úó –ù–µ—Ç –≤ –Ω–∞–ª–∏—á–∏–∏'}
                        </span>
                        <button class="btn btn-primary" onclick="openDrinkModal(${productData})">
                            –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è
                        </button>
                    </div>
                </div>
            `;
            
            drinkCards.appendChild(card);
        });
    }
    
    // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–æ–±—ã—Ç–∏–π –¥–ª—è –∫–Ω–æ–ø–∫–∏ –ø–æ–∏—Å–∫–∞
    searchBtn.addEventListener('click', function() {
        const query = mealSearch.value.trim();
        
        if (query === '') {
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –í–°–ï –Ω–∞–ø–∏—Ç–∫–∏ –∏–∑ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
            displayProducts(allProducts);
            selectedMealInfo.classList.remove('active');
            document.querySelector('.section-title').textContent = `–í–µ—Å—å –∫–∞—Ç–∞–ª–æ–≥ –Ω–∞–ø–∏—Ç–∫–æ–≤ (${allProducts.length} –Ω–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–π)`;
        } else {
            // –ò—â–µ–º –±–ª—é–¥–æ –ø–æ –Ω–∞–∑–≤–∞–Ω–∏—é
            const foundMeal = allMeals.find(meal => 
                meal.name.toLowerCase().includes(query.toLowerCase())
            );
            
            if (foundMeal) {
                selectMeal(foundMeal);
            } else {
                // –ï—Å–ª–∏ –±–ª—é–¥–æ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ, –ø–æ–∫–∞–∑—ã–≤–∞–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ
                displayProducts([]);
                selectedMealInfo.classList.remove('active');
                document.querySelector('.section-title').textContent = `–ë–ª—é–¥–æ "${query}" –Ω–µ –Ω–∞–π–¥–µ–Ω–æ`;
            }
        }
    });
    
    // –ó–∞–∫—Ä—ã—Ç–∏–µ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞ –ø—Ä–∏ –∫–ª–∏–∫–µ –≤–Ω–µ –µ–≥–æ
    document.getElementById('drink-modal').addEventListener('click', function(e) {
        if (e.target === this) {
            closeModal();
        }
    });
    
    // –ó–∞–∫—Ä—ã—Ç–∏–µ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞ –ø–æ ESC
    document.addEventListener('keydown', function(e) {
        if (e.key === 'Escape') {
            closeModal();
        }
    });
    
    // –û–±—Ä–∞–±–æ—Ç–∫–∞ –Ω–∞–∂–∞—Ç–∏—è Enter –≤ –ø–æ–ª–µ –ø–æ–∏—Å–∫–∞
    mealSearch.addEventListener('keypress', function(e) {
        if (e.key === 'Enter') {
            searchBtn.click();
        }
    });
    
    // –ó–∞–≥—Ä—É–∂–∞–µ–º –¥–∞–Ω–Ω—ã–µ –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ
    loadAllData();
});

